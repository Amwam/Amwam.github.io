<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Preventing double clicks in React | AMWAM - Amit Shah</title><meta name="next-head-count" content="3"/><link rel="preload" href="/_next/static/css/585ae7761c389af0.css" as="style"/><link rel="stylesheet" href="/_next/static/css/585ae7761c389af0.css" data-n-g=""/><link rel="preload" href="/_next/static/css/84fcc0fe545abc91.css" as="style"/><link rel="stylesheet" href="/_next/static/css/84fcc0fe545abc91.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-9b312e20a4e32339.js" defer=""></script><script src="/_next/static/chunks/framework-24fda4117f092221.js" defer=""></script><script src="/_next/static/chunks/main-a471c107d75bdeb1.js" defer=""></script><script src="/_next/static/chunks/pages/_app-665a018fe6b7d973.js" defer=""></script><script src="/_next/static/chunks/681-b41a8b768503fed7.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5Bslug%5D-30a5fc2db4b2ddab.js" defer=""></script><script src="/_next/static/FBZAs2fxMWsIW0S-AivPN/_buildManifest.js" defer=""></script><script src="/_next/static/FBZAs2fxMWsIW0S-AivPN/_ssgManifest.js" defer=""></script><script src="/_next/static/FBZAs2fxMWsIW0S-AivPN/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><div class="_app_container__HJghf"><div id="Navigation_nav-bar__qBvYL" role="navigation"><img id="Navigation_nav-display-picture__z_2_S" src="/images/me.jpg" alt="Me (Amit)" loading="lazy"/><div id="Navigation_name__xoUmt">Amit Shah</div><div id="Navigation_nav-links__c1Wi_"><div class="Navigation_nav-link__1_q_g"><a href="/">Home</a></div><div class="Navigation_nav-link__1_q_g"><a href="/about">About</a></div><div class="Navigation_nav-link__1_q_g"><a href="/blog">Blog</a></div><div class="Navigation_nav-link__1_q_g"><a href="/contact">Contact</a></div></div></div><div id="_app_content-wrapper__HNwfi"><main id="_app_content__N_c_N"><div><h1>Preventing double clicks in React</h1><h4>1/14/2019</h4><div class="style_tags__twLQV"><span><a href="/blog?tag=javascript">javascript</a> </span><span><a href="/blog?tag=react">react</a> </span></div><p>Most of the time in React you will pass an onClick handler to a button, and whenever that button is click, expect that function to be called.</p>
<pre><div style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-javascript" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span>button onClick</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#999">{</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token console" style="color:#DD4A68">console</span><span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">log</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&quot;I was called&quot;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">}</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span class="token maybe-class-name">Click</span><span> me</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">/</span><span>button</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span></code></div></pre>
<p>This <code></code> will get called, every time the button is clicked.
Sometimes this function might call an endpoint, and in some cases, you may not want that endpoint to run multiple times.</p>
<p>To get around this, you can use state to detect if the button was clicked, disable the button from being clicked further, then perform our action.
The steps would be:</p>
<ol>
<li>Click the button</li>
<li>Set the state of the component to track the button click</li>
<li>Update the button (re-render) to disable it, and prevent further clicking</li>
<li>Perform our action (using <code></code>)</li>
<li>Restore the button state, once the action is complete</li>
</ol>
<h2>Example:</h2>
<p>Below is a custom component that handles doubleclicking of buttons. All of its props are passed down to the HTML <code></code> element, except the <code></code> handler, which we will wrap with our custom logic.</p>
<pre><div style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-javascript" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token module" style="color:#07a">import</span><span> </span><span class="token imports maybe-class-name">React</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&quot;react&quot;</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token" style="color:#07a">class</span><span> </span><span class="token" style="color:#DD4A68">PreventDoubleClickButton</span><span> </span><span class="token" style="color:#07a">extends</span><span> </span><span class="token" style="color:#DD4A68">React</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">component</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>  </span><span class="token" style="color:#DD4A68">constructor</span><span class="token" style="color:#999">(</span><span class="token parameter">props</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token" style="color:#07a">super</span><span class="token" style="color:#999">(</span><span>props</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#07a">this</span><span class="token" style="color:#999">.</span><span class="token property-access">state</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">{</span><span> </span><span class="token literal-property" style="color:#905">clicked</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#905">false</span><span> </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span><span>
</span>
<span>    </span><span class="token" style="color:#07a">this</span><span class="token" style="color:#999">.</span><span class="token property-access">onClick</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#07a">this</span><span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">onClick</span><span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">bind</span><span class="token" style="color:#999">(</span><span class="token" style="color:#07a">this</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:#999">}</span><span>
</span>
<span>  </span><span class="token" style="color:#DD4A68">onClick</span><span class="token" style="color:#999">(</span><span class="token parameter">event</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token" style="color:#07a">this</span><span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">setState</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">{</span><span> </span><span class="token literal-property" style="color:#905">clicked</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#905">true</span><span> </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:#999">}</span><span>
</span>
<span>  </span><span class="token" style="color:#DD4A68">componentDidUpdate</span><span class="token" style="color:#999">(</span><span class="token parameter">prevProps</span><span class="token parameter" style="color:#999">,</span><span class="token parameter"> prevState</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token" style="color:slategray">// If we previously weren&#x27;t clicked, and then updated to be clicked, we want to run our click handler;</span><span>
</span><span>    </span><span class="token control-flow" style="color:#07a">if</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">!</span><span>prevState</span><span class="token" style="color:#999">.</span><span class="token property-access">clicked</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;&amp;</span><span> </span><span class="token" style="color:#07a">this</span><span class="token" style="color:#999">.</span><span class="token property-access">state</span><span class="token" style="color:#999">.</span><span class="token property-access">clicked</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>      </span><span class="token" style="color:slategray">// Here we expect the onClick function passed down, to return a Promise, once complete</span><span>
</span><span>      </span><span class="token" style="color:#07a">this</span><span class="token" style="color:#999">.</span><span class="token property-access">props</span><span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">onClick</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">then</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>        </span><span class="token" style="color:#07a">this</span><span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">setState</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">{</span><span> </span><span class="token literal-property" style="color:#905">clicked</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#905">true</span><span> </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>      </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span>
</span><span>  </span><span class="token" style="color:#999">}</span><span>
</span>
<span>  </span><span class="token" style="color:#DD4A68">render</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token" style="color:#999">(</span><span>
</span><span>      </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span>button </span><span class="token" style="color:#999">{</span><span class="token spread" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">...</span><span class="token" style="color:#07a">this</span><span class="token" style="color:#999">.</span><span class="token property-access">props</span><span class="token" style="color:#999">}</span><span> onClick</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#999">{</span><span class="token" style="color:#07a">this</span><span class="token" style="color:#999">.</span><span class="token property-access">onClick</span><span class="token" style="color:#999">}</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span>
</span><span>        </span><span class="token" style="color:#999">{</span><span class="token" style="color:#07a">this</span><span class="token" style="color:#999">.</span><span class="token property-access">props</span><span class="token" style="color:#999">.</span><span class="token property-access">children</span><span class="token" style="color:#999">}</span><span>
</span><span>      </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">/</span><span>button</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span>
</span><span>    </span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:#999">}</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<span></span><span class="token" style="color:slategray">// Usage</span><span>
</span>
<span></span><span class="token" style="color:#07a">function</span><span> </span><span class="token" style="color:#DD4A68">handleClick</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>  </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token" style="color:#DD4A68">fetch</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&quot;./myData.json&quot;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">then</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token" style="color:#07a">this</span><span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">setState</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">{</span><span> </span><span class="token literal-property" style="color:#905">data</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">&quot;Got it!&quot;</span><span> </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<span></span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token maybe-class-name">PreventDoubleClickButton</span><span> className</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#690">&quot;myButton&quot;</span><span> onClick</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#999">{</span><span class="token" style="color:#07a">this</span><span class="token" style="color:#999">.</span><span class="token property-access">handleClick</span><span class="token" style="color:#999">}</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span>
</span><span>  </span><span class="token maybe-class-name">Click</span><span> me
</span><span></span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">/</span><span class="token maybe-class-name">PreventDoubleClickButton</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span class="token" style="color:#999">;</span></code></div></pre></div></main></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"POST":"Most of the time in React you will pass an onClick handler to a button, and whenever that button is click, expect that function to be called.\n\n```javascript\n\u003cbutton onClick={() =\u003e console.log(\"I was called\")}\u003eClick me\u003c/button\u003e\n```\n\nThis `onClick` will get called, every time the button is clicked.\nSometimes this function might call an endpoint, and in some cases, you may not want that endpoint to run multiple times.\n\nTo get around this, you can use state to detect if the button was clicked, disable the button from being clicked further, then perform our action.\nThe steps would be:\n\n1. Click the button\n2. Set the state of the component to track the button click\n3. Update the button (re-render) to disable it, and prevent further clicking\n4. Perform our action (using `componentDidUpdate`)\n5. Restore the button state, once the action is complete\n\n## Example:\n\nBelow is a custom component that handles doubleclicking of buttons. All of its props are passed down to the HTML `button` element, except the `onClick` handler, which we will wrap with our custom logic.\n\n```javascript\nimport React from \"react\";\n\nclass PreventDoubleClickButton extends React.component {\n  constructor(props) {\n    super(props);\n    this.state = { clicked: false };\n\n    this.onClick = this.onClick.bind(this);\n  }\n\n  onClick(event) {\n    this.setState({ clicked: true });\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    // If we previously weren't clicked, and then updated to be clicked, we want to run our click handler;\n    if (!prevState.clicked \u0026\u0026 this.state.clicked) {\n      // Here we expect the onClick function passed down, to return a Promise, once complete\n      this.props.onClick().then(() =\u003e {\n        this.setState({ clicked: true });\n      });\n    }\n  }\n\n  render() {\n    return (\n      \u003cbutton {...this.props} onClick={this.onClick}\u003e\n        {this.props.children}\n      \u003c/button\u003e\n    );\n  }\n}\n\n// Usage\n\nfunction handleClick() {\n  return fetch(\"./myData.json\").then(() =\u003e {\n    this.setState({ data: \"Got it!\" });\n  });\n}\n\n\u003cPreventDoubleClickButton className=\"myButton\" onClick={this.handleClick}\u003e\n  Click me\n\u003c/PreventDoubleClickButton\u003e;\n```\n"},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"preventing-double-clicks-in-react"},"buildId":"FBZAs2fxMWsIW0S-AivPN","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>